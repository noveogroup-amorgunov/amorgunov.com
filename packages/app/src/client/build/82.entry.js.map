{"version":3,"sources":["webpack://amorgunov-com/./node_modules/@typebot/core/lib/connectors/IConnector.js","webpack://amorgunov-com/./node_modules/@typebot/core/lib/core/Bot.js","webpack://amorgunov-com/./node_modules/@typebot/core/lib/core/IMessage.js","webpack://amorgunov-com/./node_modules/@typebot/core/lib/core/Message.js","webpack://amorgunov-com/./node_modules/@typebot/core/lib/core/Session.js","webpack://amorgunov-com/./node_modules/@typebot/core/lib/stores/MemorySessionStore.js","webpack://amorgunov-com/./node_modules/d/index.js","webpack://amorgunov-com/./node_modules/es5-ext/function/noop.js","webpack://amorgunov-com/./node_modules/es5-ext/object/assign/index.js","webpack://amorgunov-com/./node_modules/es5-ext/object/assign/is-implemented.js","webpack://amorgunov-com/./node_modules/es5-ext/object/assign/shim.js","webpack://amorgunov-com/./node_modules/es5-ext/object/is-callable.js","webpack://amorgunov-com/./node_modules/es5-ext/object/is-value.js","webpack://amorgunov-com/./node_modules/es5-ext/object/keys/index.js","webpack://amorgunov-com/./node_modules/es5-ext/object/keys/is-implemented.js","webpack://amorgunov-com/./node_modules/es5-ext/object/keys/shim.js","webpack://amorgunov-com/./node_modules/es5-ext/object/normalize-options.js","webpack://amorgunov-com/./node_modules/es5-ext/object/valid-callable.js","webpack://amorgunov-com/./node_modules/es5-ext/object/valid-value.js","webpack://amorgunov-com/./node_modules/es5-ext/string/\u0000#/contains/index.js","webpack://amorgunov-com/./node_modules/es5-ext/string/\u0000#/contains/is-implemented.js","webpack://amorgunov-com/./node_modules/es5-ext/string/\u0000#/contains/shim.js","webpack://amorgunov-com/./node_modules/event-emitter/index.js","webpack://amorgunov-com/./node_modules/koa-compose/index.js","webpack://amorgunov-com/./node_modules/medium-zoom/dist/medium-zoom.esm.js"],"names":["Object","defineProperty","exports","value","ConnectorEvent","compose","MemorySessionStore_1","IConnector_1","Session_1","connector","this","initialState","handlers","sessionStore","default","Error","on","receiveMessage","processMessage","bind","context","message","key","getSessionKey","session","find","Session","user","getUser","bot","assign","add","getSession","processHandlers","catch","error","console","patternOrHandler","maybeHandler","handler","pattern","RegExp","push","ctx","next","match","getText","params","length","slice","MessageSender","Message","data","rawData","text","sessionKey","Message_1","IMessage_1","isNew","state","name","options","getUniqueSessionKey","sender","send","keys","forEach","store","Promise","resolve","normalizeOpts","isCallable","contains","module","dscr","c","e","w","desc","arguments","call","configurable","enumerable","writable","gs","get","set","undefined","obj","foo","bar","trzy","max","Math","dest","src","i","_undefined","val","isValue","object","Array","prototype","create","process","opts1","result","fn","TypeError","String","str","indexOf","searchString","once","off","emit","methods","descriptors","base","d","callable","apply","Function","defineProperties","hasOwnProperty","descriptor","type","listener","self","__eeOnceListener__","__ee__","listeners","candidate","splice","l","args","o","middleware","isArray","index","dispatch","reject","err","_extends","a","b","isSupported","tagName","isNode","nodeType","isSvg","currentSrc","substr","toLowerCase","getImagesFromSelector","filter","NodeList","isPrototypeOf","isNodeList","document","querySelectorAll","createOverlay","createElement","classList","style","background","cloneTarget","getBoundingClientRect","top","left","width","f","height","g","cloneNode","h","window","pageYOffset","documentElement","scrollTop","body","pageXOffset","scrollLeft","removeAttribute","position","transform","createCustomEvent","bubbles","cancelable","detail","CustomEvent","createEvent","initCustomEvent","insertAt","head","getElementsByTagName","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","styleInject","target","x","n","r","t","original","abs","u","v","scrollOffset","setTimeout","container","template","querySelector","dispatchEvent","zoom","y","reduce","concat","s","addEventListener","j","zoomed","remove","k","removeEventListener","toString","m","min","clientWidth","clientHeight","right","bottom","margin","zoomedHd","naturalWidth","naturalHeight","p","q","z","content","requestAnimationFrame","getAttribute","onerror","clearInterval","warn","setInterval","complete","hasAttribute","transition","opacity","removeChild","keyCode","which","open","close","toggle","update","clone","attach","detach","getOptions","getImages","getZoomedImage"],"mappings":"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","file":"82.entry.js?v=c710ca2acb6ef5e83d5b","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ConnectorEvent;\n(function (ConnectorEvent) {\n    ConnectorEvent[\"receiveMessage\"] = \"receiveMessage\";\n})(ConnectorEvent = exports.ConnectorEvent || (exports.ConnectorEvent = {}));\n//# sourceMappingURL=IConnector.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst compose = require(\"koa-compose\");\nconst MemorySessionStore_1 = require(\"../stores/MemorySessionStore\");\nconst IConnector_1 = require(\"../connectors/IConnector\");\nconst Session_1 = require(\"./Session\");\nclass Bot {\n    constructor({ connector }) {\n        this.initialState = {};\n        this.handlers = [];\n        this.sessionStore = new MemorySessionStore_1.default();\n        if (!connector) {\n            throw new Error('Connector argument is required');\n        }\n        this.connector = connector;\n        this.connector.on(IConnector_1.ConnectorEvent.receiveMessage, this.processMessage.bind(this));\n        return this;\n    }\n    async processHandlers(handlers, context) {\n        return compose(handlers)(context);\n    }\n    async getSession(message) {\n        const key = message.getSessionKey();\n        let session = await this.sessionStore.find(key);\n        if (session) {\n            return session;\n        }\n        session = new Session_1.Session({\n            user: message.getUser(),\n            bot: this,\n            initialState: Object.assign({}, this.initialState)\n        });\n        return await this.sessionStore.add(key, session);\n    }\n    async processMessage(message) {\n        const session = await this.getSession(message);\n        const context = { session, message };\n        this\n            .processHandlers(this.handlers, context)\n            .catch((error) => {\n            /* tslint:disable-next-line no-console */\n            console.error(error);\n        });\n    }\n    use(patternOrHandler, maybeHandler) {\n        const handler = maybeHandler || patternOrHandler;\n        const pattern = patternOrHandler;\n        if (typeof handler !== 'function') {\n            throw new Error('BotHandler should be function');\n        }\n        if (pattern instanceof RegExp) {\n            this.handlers.push((ctx, next) => {\n                const text = ctx.message.getText();\n                const match = text.match(pattern);\n                if (match) {\n                    ctx.params = match.length > 1 ? match.slice(1) : null;\n                    return handler(ctx, next);\n                }\n                return next();\n            });\n        }\n        else if (typeof pattern === 'string') {\n            this.handlers.push((ctx, next) => {\n                const text = ctx.message.getText();\n                if (text === pattern) {\n                    return handler(ctx, next);\n                }\n                return next();\n            });\n        }\n        else {\n            this.handlers.push(handler);\n        }\n    }\n}\nexports.default = Bot;\n//# sourceMappingURL=Bot.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar MessageSender;\n(function (MessageSender) {\n    MessageSender[MessageSender[\"bot\"] = 0] = \"bot\";\n    MessageSender[MessageSender[\"user\"] = 1] = \"user\";\n})(MessageSender = exports.MessageSender || (exports.MessageSender = {}));\n//# sourceMappingURL=IMessage.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass Message {\n    constructor(data) {\n        this.data = data;\n        return this;\n    }\n    getText() {\n        return this.data.rawData.text;\n    }\n    getUser() {\n        return this.data.user;\n    }\n    getSessionKey() {\n        return this.data.sessionKey;\n    }\n}\nexports.Message = Message;\n//# sourceMappingURL=Message.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst Message_1 = require(\"./Message\");\nconst IMessage_1 = require(\"./IMessage\");\nclass Session {\n    constructor({ user, bot, initialState }) {\n        this.initialState = {};\n        this.isNew = true;\n        this.bot = bot;\n        this.initialState = initialState || {};\n        this.state = Object.assign({}, initialState);\n        this.user = user;\n    }\n    getUsername() {\n        return this.user.name;\n    }\n    send(text, options) {\n        this.isNew = false;\n        const message = new Message_1.Message({\n            rawData: { text },\n            user: this.user,\n            sessionKey: this.bot.connector.getUniqueSessionKey(),\n            sender: IMessage_1.MessageSender.bot\n        });\n        return this.bot.connector.send(message, this.user, options);\n    }\n    resetState() {\n        this.state = Object.assign({}, this.initialState);\n    }\n    setState(state) {\n        Object.keys(state).forEach((key) => {\n            this.state[key] = state[key];\n        });\n    }\n}\nexports.Session = Session;\n//# sourceMappingURL=Session.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass MemorySessionStore {\n    constructor() {\n        this.store = {};\n    }\n    async find(key) {\n        return Promise.resolve(this.store[key]);\n    }\n    async add(key, data) {\n        this.store[key] = data;\n        return Promise.resolve(data);\n    }\n    async destroy(key) {\n        delete this.store[key];\n        return Promise.resolve();\n    }\n}\nexports.default = MemorySessionStore;\n//# sourceMappingURL=MemorySessionStore.js.map","'use strict';\n\nvar assign        = require('es5-ext/object/assign')\n  , normalizeOpts = require('es5-ext/object/normalize-options')\n  , isCallable    = require('es5-ext/object/is-callable')\n  , contains      = require('es5-ext/string/#/contains')\n\n  , d;\n\nd = module.exports = function (dscr, value/*, options*/) {\n\tvar c, e, w, options, desc;\n\tif ((arguments.length < 2) || (typeof dscr !== 'string')) {\n\t\toptions = value;\n\t\tvalue = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[2];\n\t}\n\tif (dscr == null) {\n\t\tc = w = true;\n\t\te = false;\n\t} else {\n\t\tc = contains.call(dscr, 'c');\n\t\te = contains.call(dscr, 'e');\n\t\tw = contains.call(dscr, 'w');\n\t}\n\n\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n\nd.gs = function (dscr, get, set/*, options*/) {\n\tvar c, e, options, desc;\n\tif (typeof dscr !== 'string') {\n\t\toptions = set;\n\t\tset = get;\n\t\tget = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[3];\n\t}\n\tif (get == null) {\n\t\tget = undefined;\n\t} else if (!isCallable(get)) {\n\t\toptions = get;\n\t\tget = set = undefined;\n\t} else if (set == null) {\n\t\tset = undefined;\n\t} else if (!isCallable(set)) {\n\t\toptions = set;\n\t\tset = undefined;\n\t}\n\tif (dscr == null) {\n\t\tc = true;\n\t\te = false;\n\t} else {\n\t\tc = contains.call(dscr, 'c');\n\t\te = contains.call(dscr, 'e');\n\t}\n\n\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n","\"use strict\";\n\n// eslint-disable-next-line no-empty-function\nmodule.exports = function () {};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")()\n\t? Object.assign\n\t: require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar assign = Object.assign, obj;\n\tif (typeof assign !== \"function\") return false;\n\tobj = { foo: \"raz\" };\n\tassign(obj, { bar: \"dwa\" }, { trzy: \"trzy\" });\n\treturn (obj.foo + obj.bar + obj.trzy) === \"razdwatrzy\";\n};\n","\"use strict\";\n\nvar keys  = require(\"../keys\")\n  , value = require(\"../valid-value\")\n  , max   = Math.max;\n\nmodule.exports = function (dest, src /*, …srcn*/) {\n\tvar error, i, length = max(arguments.length, 2), assign;\n\tdest = Object(value(dest));\n\tassign = function (key) {\n\t\ttry {\n\t\t\tdest[key] = src[key];\n\t\t} catch (e) {\n\t\t\tif (!error) error = e;\n\t\t}\n\t};\n\tfor (i = 1; i < length; ++i) {\n\t\tsrc = arguments[i];\n\t\tkeys(src).forEach(assign);\n\t}\n\tif (error !== undefined) throw error;\n\treturn dest;\n};\n","// Deprecated\n\n\"use strict\";\n\nmodule.exports = function (obj) {\n return typeof obj === \"function\";\n};\n","\"use strict\";\n\nvar _undefined = require(\"../function/noop\")(); // Support ES3 engines\n\nmodule.exports = function (val) {\n return (val !== _undefined) && (val !== null);\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.keys : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\ttry {\n\t\tObject.keys(\"primitive\");\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isValue = require(\"../is-value\");\n\nvar keys = Object.keys;\n\nmodule.exports = function (object) { return keys(isValue(object) ? Object(object) : object); };\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nvar forEach = Array.prototype.forEach, create = Object.create;\n\nvar process = function (src, obj) {\n\tvar key;\n\tfor (key in src) obj[key] = src[key];\n};\n\n// eslint-disable-next-line no-unused-vars\nmodule.exports = function (opts1 /*, …options*/) {\n\tvar result = create(null);\n\tforEach.call(arguments, function (options) {\n\t\tif (!isValue(options)) return;\n\t\tprocess(Object(options), result);\n\t});\n\treturn result;\n};\n","\"use strict\";\n\nmodule.exports = function (fn) {\n\tif (typeof fn !== \"function\") throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) throw new TypeError(\"Cannot use null or undefined\");\n\treturn value;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")()\n\t? String.prototype.contains\n\t: require(\"./shim\");\n","\"use strict\";\n\nvar str = \"razdwatrzy\";\n\nmodule.exports = function () {\n\tif (typeof str.contains !== \"function\") return false;\n\treturn (str.contains(\"dwa\") === true) && (str.contains(\"foo\") === false);\n};\n","\"use strict\";\n\nvar indexOf = String.prototype.indexOf;\n\nmodule.exports = function (searchString/*, position*/) {\n\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n};\n","'use strict';\n\nvar d        = require('d')\n  , callable = require('es5-ext/object/valid-callable')\n\n  , apply = Function.prototype.apply, call = Function.prototype.call\n  , create = Object.create, defineProperty = Object.defineProperty\n  , defineProperties = Object.defineProperties\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , descriptor = { configurable: true, enumerable: false, writable: true }\n\n  , on, once, off, emit, methods, descriptors, base;\n\non = function (type, listener) {\n\tvar data;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) {\n\t\tdata = descriptor.value = create(null);\n\t\tdefineProperty(this, '__ee__', descriptor);\n\t\tdescriptor.value = null;\n\t} else {\n\t\tdata = this.__ee__;\n\t}\n\tif (!data[type]) data[type] = listener;\n\telse if (typeof data[type] === 'object') data[type].push(listener);\n\telse data[type] = [data[type], listener];\n\n\treturn this;\n};\n\nonce = function (type, listener) {\n\tvar once, self;\n\n\tcallable(listener);\n\tself = this;\n\ton.call(this, type, once = function () {\n\t\toff.call(self, type, once);\n\t\tapply.call(listener, this, arguments);\n\t});\n\n\tonce.__eeOnceListener__ = listener;\n\treturn this;\n};\n\noff = function (type, listener) {\n\tvar data, listeners, candidate, i;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return this;\n\tdata = this.__ee__;\n\tif (!data[type]) return this;\n\tlisteners = data[type];\n\n\tif (typeof listeners === 'object') {\n\t\tfor (i = 0; (candidate = listeners[i]); ++i) {\n\t\t\tif ((candidate === listener) ||\n\t\t\t\t\t(candidate.__eeOnceListener__ === listener)) {\n\t\t\t\tif (listeners.length === 2) data[type] = listeners[i ? 0 : 1];\n\t\t\t\telse listeners.splice(i, 1);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ((listeners === listener) ||\n\t\t\t\t(listeners.__eeOnceListener__ === listener)) {\n\t\t\tdelete data[type];\n\t\t}\n\t}\n\n\treturn this;\n};\n\nemit = function (type) {\n\tvar i, l, listener, listeners, args;\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return;\n\tlisteners = this.__ee__[type];\n\tif (!listeners) return;\n\n\tif (typeof listeners === 'object') {\n\t\tl = arguments.length;\n\t\targs = new Array(l - 1);\n\t\tfor (i = 1; i < l; ++i) args[i - 1] = arguments[i];\n\n\t\tlisteners = listeners.slice();\n\t\tfor (i = 0; (listener = listeners[i]); ++i) {\n\t\t\tapply.call(listener, this, args);\n\t\t}\n\t} else {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tcall.call(listeners, this);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcall.call(listeners, this, arguments[1]);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tcall.call(listeners, this, arguments[1], arguments[2]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tl = arguments.length;\n\t\t\targs = new Array(l - 1);\n\t\t\tfor (i = 1; i < l; ++i) {\n\t\t\t\targs[i - 1] = arguments[i];\n\t\t\t}\n\t\t\tapply.call(listeners, this, args);\n\t\t}\n\t}\n};\n\nmethods = {\n\ton: on,\n\tonce: once,\n\toff: off,\n\temit: emit\n};\n\ndescriptors = {\n\ton: d(on),\n\tonce: d(once),\n\toff: d(off),\n\temit: d(emit)\n};\n\nbase = defineProperties({}, descriptors);\n\nmodule.exports = exports = function (o) {\n\treturn (o == null) ? create(base) : defineProperties(Object(o), descriptors);\n};\nexports.methods = methods;\n","'use strict'\n\n/**\n * Expose compositor.\n */\n\nmodule.exports = compose\n\n/**\n * Compose `middleware` returning\n * a fully valid middleware comprised\n * of all those which are passed.\n *\n * @param {Array} middleware\n * @return {Function}\n * @api public\n */\n\nfunction compose (middleware) {\n  if (!Array.isArray(middleware)) throw new TypeError('Middleware stack must be an array!')\n  for (const fn of middleware) {\n    if (typeof fn !== 'function') throw new TypeError('Middleware must be composed of functions!')\n  }\n\n  /**\n   * @param {Object} context\n   * @return {Promise}\n   * @api public\n   */\n\n  return function (context, next) {\n    // last called middleware #\n    let index = -1\n    return dispatch(0)\n    function dispatch (i) {\n      if (i <= index) return Promise.reject(new Error('next() called multiple times'))\n      index = i\n      let fn = middleware[i]\n      if (i === middleware.length) fn = next\n      if (!fn) return Promise.resolve()\n      try {\n        return Promise.resolve(fn(context, dispatch.bind(null, i + 1)));\n      } catch (err) {\n        return Promise.reject(err)\n      }\n    }\n  }\n}\n","/*! medium-zoom 1.0.4 | MIT License | https://github.com/francoischalifour/medium-zoom */var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},isSupported=function(a){return'IMG'===a.tagName},isNodeList=function(a){return NodeList.prototype.isPrototypeOf(a)},isNode=function(a){return a&&1===a.nodeType},isSvg=function(a){var b=a.currentSrc||a.src;return'.svg'===b.substr(-4).toLowerCase()},getImagesFromSelector=function(a){try{return Array.isArray(a)?a.filter(isSupported):isNodeList(a)?[].slice.call(a).filter(isSupported):isNode(a)?[a].filter(isSupported):'string'==typeof a?[].slice.call(document.querySelectorAll(a)).filter(isSupported):[]}catch(a){throw new TypeError('The provided selector is invalid.\\nExpects a CSS selector, a Node element, a NodeList or an array.\\nSee: https://github.com/francoischalifour/medium-zoom')}},createOverlay=function(a){var b=document.createElement('div');return b.classList.add('medium-zoom-overlay'),b.style.background=a,b},cloneTarget=function(a){var b=a.getBoundingClientRect(),c=b.top,d=b.left,e=b.width,f=b.height,g=a.cloneNode(),h=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,i=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return g.removeAttribute('id'),g.style.position='absolute',g.style.top=c+h+'px',g.style.left=d+i+'px',g.style.width=e+'px',g.style.height=f+'px',g.style.transform='',g},createCustomEvent=function(a,b){var c=_extends({bubbles:!1,cancelable:!1,detail:void 0},b);if('function'==typeof window.CustomEvent)return new CustomEvent(a,c);var d=document.createEvent('CustomEvent');return d.initCustomEvent(a,c.bubbles,c.cancelable,c.detail),d},mediumZoom=function a(b){var c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},d=window.Promise||function(a){function b(){}a(b,b)},e=function(a){var b=a.target;return b===x?void n():void(-1===r.indexOf(b)||o({target:b}))},f=function(){if(!t&&w.original){var a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(u-a)>v.scrollOffset&&setTimeout(n,150)}},g=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},b=a;if(a.background&&(x.style.background=a.background),a.container&&a.container instanceof Object&&(b.container=_extends({},v.container,a.container)),a.template){var c=isNode(a.template)?a.template:document.querySelector(a.template);b.template=c}return v=_extends({},v,b),r.forEach(function(a){a.dispatchEvent(createCustomEvent('medium-zoom:update',{detail:{zoom:y}}))}),y},h=function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return a(_extends({},v,b))},i=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];var d=b.reduce(function(a,b){return[].concat(a,getImagesFromSelector(b))},[]);return d.filter(function(a){return-1===r.indexOf(a)}).forEach(function(a){r.push(a),a.classList.add('medium-zoom-image')}),s.forEach(function(a){var b=a.type,c=a.listener,e=a.options;d.forEach(function(a){a.addEventListener(b,c,e)})}),y},j=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];w.zoomed&&n();var d=0<b.length?b.reduce(function(a,b){return[].concat(a,getImagesFromSelector(b))},[]):r;return d.forEach(function(a){a.classList.remove('medium-zoom-image'),a.dispatchEvent(createCustomEvent('medium-zoom:detach',{detail:{zoom:y}}))}),r=r.filter(function(a){return-1===d.indexOf(a)}),y},k=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return r.forEach(function(d){d.addEventListener('medium-zoom:'+a,b,c)}),s.push({type:'medium-zoom:'+a,listener:b,options:c}),y},l=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return r.forEach(function(d){d.removeEventListener('medium-zoom:'+a,b,c)}),s=s.filter(function(c){return c.type!=='medium-zoom:'+a||c.listener.toString()!==b.toString()}),y},m=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},b=a.target,c=function(){var a=Math.min,b={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},c=void 0,d=void 0;if(v.container)if(v.container instanceof Object)b=_extends({},b,v.container),c=b.width-b.left-b.right-2*v.margin,d=b.height-b.top-b.bottom-2*v.margin;else{var e=isNode(v.container)?v.container:document.querySelector(v.container),f=e.getBoundingClientRect(),g=f.width,h=f.height,i=f.left,j=f.top;b=_extends({},b,{width:g,height:h,left:i,top:j})}c=c||b.width-2*v.margin,d=d||b.height-2*v.margin;var k=w.zoomedHd||w.original,l=isSvg(k)?c:k.naturalWidth||c,m=isSvg(k)?d:k.naturalHeight||d,n=k.getBoundingClientRect(),o=n.top,p=n.left,q=n.width,r=n.height,s=a(l,c)/q,t=a(m,d)/r,u=a(s,t),x=(-p+(c-q)/2+v.margin+b.left)/u,y=(-o+(d-r)/2+v.margin+b.top)/u,z='scale('+u+') translate3d('+x+'px, '+y+'px, 0)';w.zoomed.style.transform=z,w.zoomedHd&&(w.zoomedHd.style.transform=z)};return new d(function(a){if(b&&-1===r.indexOf(b))return void a(y);if(w.zoomed)return void a(y);if(b)w.original=b;else if(0<r.length){var d=r;w.original=d[0]}else return void a(y);if(w.original.dispatchEvent(createCustomEvent('medium-zoom:open',{detail:{zoom:y}})),u=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,t=!0,w.zoomed=cloneTarget(w.original),document.body.appendChild(x),v.template){var e=isNode(v.template)?v.template:document.querySelector(v.template);w.template=document.createElement('div'),w.template.appendChild(e.content.cloneNode(!0)),document.body.appendChild(w.template)}if(document.body.appendChild(w.zoomed),window.requestAnimationFrame(function(){document.body.classList.add('medium-zoom--opened')}),w.original.classList.add('medium-zoom-image--hidden'),w.zoomed.classList.add('medium-zoom-image--opened'),w.zoomed.addEventListener('click',n),w.zoomed.addEventListener('transitionend',function b(){t=!1,w.zoomed.removeEventListener('transitionend',b),w.original.dispatchEvent(createCustomEvent('medium-zoom:opened',{detail:{zoom:y}})),a(y)}),w.original.getAttribute('data-zoom-src')){w.zoomedHd=w.zoomed.cloneNode(),w.zoomedHd.removeAttribute('srcset'),w.zoomedHd.removeAttribute('sizes'),w.zoomedHd.src=w.zoomed.getAttribute('data-zoom-src'),w.zoomedHd.onerror=function(){clearInterval(f),console.warn('Unable to reach the zoom image target '+w.zoomedHd.src),w.zoomedHd=null,c()};var f=setInterval(function(){w.zoomedHd.complete&&(clearInterval(f),w.zoomedHd.classList.add('medium-zoom-image--opened'),w.zoomedHd.addEventListener('click',n),document.body.appendChild(w.zoomedHd),c())},10)}else if(w.original.hasAttribute('srcset')){w.zoomedHd=w.zoomed.cloneNode(),w.zoomedHd.removeAttribute('sizes');var g=w.zoomedHd.addEventListener('load',function(){w.zoomedHd.removeEventListener('load',g),w.zoomedHd.classList.add('medium-zoom-image--opened'),w.zoomedHd.addEventListener('click',n),document.body.appendChild(w.zoomedHd),c()})}else c()})},n=function(){return new d(function(a){if(t||!w.original)return void a(y);t=!0,document.body.classList.remove('medium-zoom--opened'),w.zoomed.style.transform='',w.zoomedHd&&(w.zoomedHd.style.transform=''),w.template&&(w.template.style.transition='opacity 150ms',w.template.style.opacity=0),w.original.dispatchEvent(createCustomEvent('medium-zoom:close',{detail:{zoom:y}})),w.zoomed.addEventListener('transitionend',function b(){w.original.classList.remove('medium-zoom-image--hidden'),document.body.removeChild(w.zoomed),w.zoomedHd&&document.body.removeChild(w.zoomedHd),document.body.removeChild(x),w.zoomed.classList.remove('medium-zoom-image--opened'),w.template&&document.body.removeChild(w.template),t=!1,w.zoomed.removeEventListener('transitionend',b),w.original.dispatchEvent(createCustomEvent('medium-zoom:closed',{detail:{zoom:y}})),w.original=null,w.zoomed=null,w.zoomedHd=null,w.template=null,a(y)})})},o=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},b=a.target;return w.original?n():m({target:b})},p=function(){return v},q=function(){return r},r=[],s=[],t=!1,u=0,v=c,w={original:null,zoomed:null,zoomedHd:null,template:null};'[object Object]'===Object.prototype.toString.call(b)?v=b:(b||'string'==typeof b)&&i(b),v=_extends({margin:0,background:'#fff',scrollOffset:40,container:null,template:null},v);var x=createOverlay(v.background);document.addEventListener('click',e),document.addEventListener('keyup',function(a){27===(a.keyCode||a.which)&&n()}),document.addEventListener('scroll',f),window.addEventListener('resize',n);var y={open:m,close:n,toggle:o,update:g,clone:h,attach:i,detach:j,on:k,off:l,getOptions:p,getImages:q,getZoomedImage:function(){return w.original}};return y};function styleInject(a,b){void 0===b&&(b={});var c=b.insertAt;if(a&&'undefined'!=typeof document){var d=document.head||document.getElementsByTagName('head')[0],e=document.createElement('style');e.type='text/css','top'===c?d.firstChild?d.insertBefore(e,d.firstChild):d.appendChild(e):d.appendChild(e),e.styleSheet?e.styleSheet.cssText=a:e.appendChild(document.createTextNode(a))}}var css='.medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}';styleInject('.medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}');export default mediumZoom;\n"],"sourceRoot":""}